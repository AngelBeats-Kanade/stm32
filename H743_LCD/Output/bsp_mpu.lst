ARM GAS  /tmp/ccsVdeTU.s 			page 1


   1              		.cpu cortex-m7
   2              		.eabi_attribute 28, 1
   3              		.eabi_attribute 20, 1
   4              		.eabi_attribute 21, 1
   5              		.eabi_attribute 23, 3
   6              		.eabi_attribute 24, 1
   7              		.eabi_attribute 25, 1
   8              		.eabi_attribute 26, 1
   9              		.eabi_attribute 30, 1
  10              		.eabi_attribute 34, 1
  11              		.eabi_attribute 18, 4
  12              		.file	"bsp_mpu.c"
  13              		.text
  14              	.Ltext0:
  15              		.cfi_sections	.debug_frame
  16              		.section	.text.BSP_MPU_ConfigRegion,"ax",%progbits
  17              		.align	1
  18              		.global	BSP_MPU_ConfigRegion
  19              		.syntax unified
  20              		.thumb
  21              		.thumb_func
  22              		.fpu fpv5-d16
  24              	BSP_MPU_ConfigRegion:
  25              	.LFB141:
  26              		.file 1 "User/mpu/bsp_mpu.c"
   1:User/mpu/bsp_mpu.c **** /**
   2:User/mpu/bsp_mpu.c ****  ******************************************************************
   3:User/mpu/bsp_mpu.c ****  * @file    bsp_mpu.c
   4:User/mpu/bsp_mpu.c ****  * @author  fire
   5:User/mpu/bsp_mpu.c ****  * @version V1.0
   6:User/mpu/bsp_mpu.c ****  * @date    2018-xx-xx
   7:User/mpu/bsp_mpu.c ****  * @brief   配置MPU区域属性和大小
   8:User/mpu/bsp_mpu.c ****  ******************************************************************
   9:User/mpu/bsp_mpu.c ****  * @attention
  10:User/mpu/bsp_mpu.c ****  *
  11:User/mpu/bsp_mpu.c ****  * 实验平台:野火 STM32H743开发板
  12:User/mpu/bsp_mpu.c ****  * 论坛    :http://www.firebbs.cn
  13:User/mpu/bsp_mpu.c ****  * 淘宝    :http://firestm32.taobao.com
  14:User/mpu/bsp_mpu.c ****  *
  15:User/mpu/bsp_mpu.c ****  ******************************************************************
  16:User/mpu/bsp_mpu.c ****  */
  17:User/mpu/bsp_mpu.c **** #include "./mpu/bsp_mpu.h"
  18:User/mpu/bsp_mpu.c **** 
  19:User/mpu/bsp_mpu.c **** /**
  20:User/mpu/bsp_mpu.c ****  * @brief  配置MPU区域属性和大小寄存器值
  21:User/mpu/bsp_mpu.c ****  * @param  Region  					MPU保护区域，取值范围（0―7）
  22:User/mpu/bsp_mpu.c ****  * @param  DisableExec  			指令访问禁用位，0=允许指令访问，1=禁止指令访问。
  23:User/mpu/bsp_mpu.c ****  * @param  AccessPermission	数据访问权限，取值范围（MPU_NO_ACCESS―MPU_PRIV_RO_URO）
  24:User/mpu/bsp_mpu.c ****  * @param  TypeExtField 			键入扩展字段，允许您配置内存访问类型，例如强排序，外设。
  25:User/mpu/bsp_mpu.c ****  *														可以取值（0，1，2）
  26:User/mpu/bsp_mpu.c ****  * @param  Address 					MPU保护区域基地址，特别注意配置的Address需要被Size整除
  27:User/mpu/bsp_mpu.c ****  * @param  Size 							MPU保护区域大小,可以取值（MPU_1KB，MPU_4KB
  28:User/mpu/bsp_mpu.c ****  *...MPU_512MB）
  29:User/mpu/bsp_mpu.c ****  * @param  IsShareable 			保护的存储空间是否可以共享，1=允许共享，0=禁止共享。
  30:User/mpu/bsp_mpu.c ****  * @param  IsCacheable 			保护的存储空间是否可以缓存，1=允许缓存，0=禁止缓存。
  31:User/mpu/bsp_mpu.c ****  * @param  IsBufferable 			使能Cache之后，策略是write-through还是write-back(bufferable)
  32:User/mpu/bsp_mpu.c ****  *												    1=允许缓冲，即回写（write-back），0=禁止缓冲，即直写（write-through）。
ARM GAS  /tmp/ccsVdeTU.s 			page 2


  33:User/mpu/bsp_mpu.c ****  * @retval None
  34:User/mpu/bsp_mpu.c ****  */
  35:User/mpu/bsp_mpu.c **** void BSP_MPU_ConfigRegion(uint8_t Region, uint8_t DisableExec, uint8_t AccessPermission, uint8_t Ty
  36:User/mpu/bsp_mpu.c ****                           uint32_t Address, uint32_t Size, uint8_t IsShareable, uint8_t IsCacheable
  37:User/mpu/bsp_mpu.c ****                           uint8_t IsBufferable)
  38:User/mpu/bsp_mpu.c **** {
  27              		.loc 1 38 0
  28              		.cfi_startproc
  29              		@ args = 20, pretend = 0, frame = 16
  30              		@ frame_needed = 0, uses_anonymous_args = 0
  31              	.LVL0:
  32 0000 F0B5     		push	{r4, r5, r6, r7, lr}
  33              	.LCFI0:
  34              		.cfi_def_cfa_offset 20
  35              		.cfi_offset 4, -20
  36              		.cfi_offset 5, -16
  37              		.cfi_offset 6, -12
  38              		.cfi_offset 7, -8
  39              		.cfi_offset 14, -4
  40 0002 85B0     		sub	sp, sp, #20
  41              	.LCFI1:
  42              		.cfi_def_cfa_offset 40
  43 0004 0646     		mov	r6, r0
  44 0006 0C46     		mov	r4, r1
  45 0008 1746     		mov	r7, r2
  46 000a 1D46     		mov	r5, r3
  39:User/mpu/bsp_mpu.c ****   MPU_Region_InitTypeDef MPU_InitStruct;
  40:User/mpu/bsp_mpu.c **** 
  41:User/mpu/bsp_mpu.c ****   /* 禁用MPU */
  42:User/mpu/bsp_mpu.c ****   HAL_MPU_Disable();
  47              		.loc 1 42 0
  48 000c FFF7FEFF 		bl	HAL_MPU_Disable
  49              	.LVL1:
  43:User/mpu/bsp_mpu.c **** 
  44:User/mpu/bsp_mpu.c ****   /* 配置MPU属性*/
  45:User/mpu/bsp_mpu.c ****   MPU_InitStruct.Enable = MPU_REGION_ENABLE;
  50              		.loc 1 45 0
  51 0010 0123     		movs	r3, #1
  52 0012 8DF80030 		strb	r3, [sp]
  46:User/mpu/bsp_mpu.c ****   MPU_InitStruct.BaseAddress = Address; //区域基地址。
  53              		.loc 1 46 0
  54 0016 0A9B     		ldr	r3, [sp, #40]
  55 0018 0193     		str	r3, [sp, #4]
  47:User/mpu/bsp_mpu.c ****   MPU_InitStruct.Size = Size;           //要配置的区域的区域大小。
  56              		.loc 1 47 0
  57 001a 0B9B     		ldr	r3, [sp, #44]
  58 001c 8DF80830 		strb	r3, [sp, #8]
  48:User/mpu/bsp_mpu.c ****   MPU_InitStruct.AccessPermission = AccessPermission; //数据访问权限允许您配置用户和特权模式的读/写
  59              		.loc 1 48 0
  60 0020 8DF80B70 		strb	r7, [sp, #11]
  49:User/mpu/bsp_mpu.c ****   MPU_InitStruct.IsBufferable = IsBufferable; //区域是可缓冲的，即使用回写缓存。 可缓存但不可缓冲的
  61              		.loc 1 49 0
  62 0024 9DF83830 		ldrb	r3, [sp, #56]	@ zero_extendqisi2
  63 0028 8DF80F30 		strb	r3, [sp, #15]
  50:User/mpu/bsp_mpu.c ****   MPU_InitStruct.IsCacheable = IsCacheable;   //区域是否可缓存的，即其值是否可以保存在缓存中。
  64              		.loc 1 50 0
  65 002c 9DF83430 		ldrb	r3, [sp, #52]	@ zero_extendqisi2
ARM GAS  /tmp/ccsVdeTU.s 			page 3


  66 0030 8DF80E30 		strb	r3, [sp, #14]
  51:User/mpu/bsp_mpu.c ****   MPU_InitStruct.IsShareable = IsShareable;   //区域是否可以在多个总线主控器之间共享。
  67              		.loc 1 51 0
  68 0034 9DF83030 		ldrb	r3, [sp, #48]	@ zero_extendqisi2
  69 0038 8DF80D30 		strb	r3, [sp, #13]
  52:User/mpu/bsp_mpu.c ****   MPU_InitStruct.Number = Region;             //区域保护。
  70              		.loc 1 52 0
  71 003c 8DF80160 		strb	r6, [sp, #1]
  53:User/mpu/bsp_mpu.c ****   MPU_InitStruct.TypeExtField = TypeExtField; //键入扩展字段，允许您配置内存访问类型。
  72              		.loc 1 53 0
  73 0040 8DF80A50 		strb	r5, [sp, #10]
  54:User/mpu/bsp_mpu.c ****   MPU_InitStruct.SubRegionDisable = 0x00;     //子区域禁用字段。
  74              		.loc 1 54 0
  75 0044 0023     		movs	r3, #0
  76 0046 8DF80930 		strb	r3, [sp, #9]
  55:User/mpu/bsp_mpu.c ****   MPU_InitStruct.DisableExec = DisableExec;   //指令访问禁用位。
  77              		.loc 1 55 0
  78 004a 8DF80C40 		strb	r4, [sp, #12]
  56:User/mpu/bsp_mpu.c **** 
  57:User/mpu/bsp_mpu.c ****   HAL_MPU_ConfigRegion(&MPU_InitStruct);
  79              		.loc 1 57 0
  80 004e 6846     		mov	r0, sp
  81 0050 FFF7FEFF 		bl	HAL_MPU_ConfigRegion
  82              	.LVL2:
  58:User/mpu/bsp_mpu.c **** 
  59:User/mpu/bsp_mpu.c ****   /* 启用MPU */
  60:User/mpu/bsp_mpu.c ****   HAL_MPU_Enable(MPU_PRIVILEGED_DEFAULT);
  83              		.loc 1 60 0
  84 0054 0420     		movs	r0, #4
  85 0056 FFF7FEFF 		bl	HAL_MPU_Enable
  86              	.LVL3:
  61:User/mpu/bsp_mpu.c **** }
  87              		.loc 1 61 0
  88 005a 05B0     		add	sp, sp, #20
  89              	.LCFI2:
  90              		.cfi_def_cfa_offset 20
  91              		@ sp needed
  92 005c F0BD     		pop	{r4, r5, r6, r7, pc}
  93              		.cfi_endproc
  94              	.LFE141:
  96              		.section	.text.Board_MPU_Config,"ax",%progbits
  97              		.align	1
  98              		.global	Board_MPU_Config
  99              		.syntax unified
 100              		.thumb
 101              		.thumb_func
 102              		.fpu fpv5-d16
 104              	Board_MPU_Config:
 105              	.LFB142:
  62:User/mpu/bsp_mpu.c **** 
  63:User/mpu/bsp_mpu.c **** void Board_MPU_Config(uint8_t Region, uint8_t Mode, uint32_t Address, uint32_t Size)
  64:User/mpu/bsp_mpu.c **** {
 106              		.loc 1 64 0
 107              		.cfi_startproc
 108              		@ args = 0, pretend = 0, frame = 0
 109              		@ frame_needed = 0, uses_anonymous_args = 0
 110              	.LVL4:
ARM GAS  /tmp/ccsVdeTU.s 			page 4


 111 0000 10B5     		push	{r4, lr}
 112              	.LCFI3:
 113              		.cfi_def_cfa_offset 8
 114              		.cfi_offset 4, -8
 115              		.cfi_offset 14, -4
 116 0002 86B0     		sub	sp, sp, #24
 117              	.LCFI4:
 118              		.cfi_def_cfa_offset 32
  65:User/mpu/bsp_mpu.c ****   switch (Mode)
 119              		.loc 1 65 0
 120 0004 0429     		cmp	r1, #4
 121 0006 0FD8     		bhi	.L3
 122 0008 DFE801F0 		tbb	[pc, r1]
 123              	.L6:
 124 000c 03       		.byte	(.L5-.L6)/2
 125 000d 10       		.byte	(.L7-.L6)/2
 126 000e 1C       		.byte	(.L8-.L6)/2
 127 000f 28       		.byte	(.L9-.L6)/2
 128 0010 33       		.byte	(.L10-.L6)/2
 129 0011 00       		.p2align 1
 130              	.L5:
  66:User/mpu/bsp_mpu.c ****   {
  67:User/mpu/bsp_mpu.c ****   case MPU_Normal_WB:
  68:User/mpu/bsp_mpu.c ****     /* 设置内存为Normal类型,禁用共享, 回写模式不带写入读取分配*/
  69:User/mpu/bsp_mpu.c ****     BSP_MPU_ConfigRegion(Region, 0, MPU_FULL_ACCESS, 0, Address, Size, 0, 1, 1);
 131              		.loc 1 69 0
 132 0012 0121     		movs	r1, #1
 133              	.LVL5:
 134 0014 0491     		str	r1, [sp, #16]
 135 0016 0391     		str	r1, [sp, #12]
 136 0018 0021     		movs	r1, #0
 137 001a 0291     		str	r1, [sp, #8]
 138 001c 0193     		str	r3, [sp, #4]
 139 001e 0092     		str	r2, [sp]
 140 0020 0B46     		mov	r3, r1
 141              	.LVL6:
 142 0022 0322     		movs	r2, #3
 143              	.LVL7:
 144 0024 FFF7FEFF 		bl	BSP_MPU_ConfigRegion
 145              	.LVL8:
 146              	.L3:
  70:User/mpu/bsp_mpu.c ****     break;
  71:User/mpu/bsp_mpu.c **** 
  72:User/mpu/bsp_mpu.c ****   case MPU_Normal_WBWARA:
  73:User/mpu/bsp_mpu.c ****     /* 设置内存为Normal类型,禁用共享, 回写模式带写入读取分配*/
  74:User/mpu/bsp_mpu.c ****     BSP_MPU_ConfigRegion(Region, 0, MPU_FULL_ACCESS, 1, Address, Size, 0, 1, 1);
  75:User/mpu/bsp_mpu.c ****     break;
  76:User/mpu/bsp_mpu.c **** 
  77:User/mpu/bsp_mpu.c ****   case MPU_Normal_WT:
  78:User/mpu/bsp_mpu.c ****     /* 设置内存为Normal类型,禁用共享, 直写模式*/
  79:User/mpu/bsp_mpu.c ****     BSP_MPU_ConfigRegion(Region, 0, MPU_FULL_ACCESS, 0, Address, Size, 0, 1, 0);
  80:User/mpu/bsp_mpu.c ****     break;
  81:User/mpu/bsp_mpu.c **** 
  82:User/mpu/bsp_mpu.c ****   case MPU_Normal_NonCache:
  83:User/mpu/bsp_mpu.c ****     /* 设置内存为Normal类型,禁用共享，禁用缓存模式*/
  84:User/mpu/bsp_mpu.c ****     BSP_MPU_ConfigRegion(Region, 0, MPU_FULL_ACCESS, 1, Address, Size, 0, 0, 0);
  85:User/mpu/bsp_mpu.c ****     break;
ARM GAS  /tmp/ccsVdeTU.s 			page 5


  86:User/mpu/bsp_mpu.c **** 
  87:User/mpu/bsp_mpu.c ****   case MPU_Device_NonCache:
  88:User/mpu/bsp_mpu.c ****     /*设置内存为Device类型,共享设置无效，禁止共享，禁用缓存模式*/
  89:User/mpu/bsp_mpu.c ****     BSP_MPU_ConfigRegion(Region, 0, MPU_FULL_ACCESS, 2, Address, Size, 0, 0, 0);
  90:User/mpu/bsp_mpu.c ****     break;
  91:User/mpu/bsp_mpu.c ****   }
  92:User/mpu/bsp_mpu.c **** }
 147              		.loc 1 92 0
 148 0028 06B0     		add	sp, sp, #24
 149              	.LCFI5:
 150              		.cfi_remember_state
 151              		.cfi_def_cfa_offset 8
 152              		@ sp needed
 153 002a 10BD     		pop	{r4, pc}
 154              	.LVL9:
 155              	.L7:
 156              	.LCFI6:
 157              		.cfi_restore_state
  74:User/mpu/bsp_mpu.c ****     break;
 158              		.loc 1 74 0
 159 002c 0124     		movs	r4, #1
 160 002e 0494     		str	r4, [sp, #16]
 161 0030 0394     		str	r4, [sp, #12]
 162 0032 0021     		movs	r1, #0
 163              	.LVL10:
 164 0034 0291     		str	r1, [sp, #8]
 165 0036 0193     		str	r3, [sp, #4]
 166 0038 0092     		str	r2, [sp]
 167 003a 2346     		mov	r3, r4
 168              	.LVL11:
 169 003c 0322     		movs	r2, #3
 170              	.LVL12:
 171 003e FFF7FEFF 		bl	BSP_MPU_ConfigRegion
 172              	.LVL13:
  75:User/mpu/bsp_mpu.c **** 
 173              		.loc 1 75 0
 174 0042 F1E7     		b	.L3
 175              	.LVL14:
 176              	.L8:
  79:User/mpu/bsp_mpu.c ****     break;
 177              		.loc 1 79 0
 178 0044 0021     		movs	r1, #0
 179              	.LVL15:
 180 0046 0491     		str	r1, [sp, #16]
 181 0048 0124     		movs	r4, #1
 182 004a 0394     		str	r4, [sp, #12]
 183 004c 0291     		str	r1, [sp, #8]
 184 004e 0193     		str	r3, [sp, #4]
 185 0050 0092     		str	r2, [sp]
 186 0052 0B46     		mov	r3, r1
 187              	.LVL16:
 188 0054 0322     		movs	r2, #3
 189              	.LVL17:
 190 0056 FFF7FEFF 		bl	BSP_MPU_ConfigRegion
 191              	.LVL18:
  80:User/mpu/bsp_mpu.c **** 
 192              		.loc 1 80 0
ARM GAS  /tmp/ccsVdeTU.s 			page 6


 193 005a E5E7     		b	.L3
 194              	.LVL19:
 195              	.L9:
  84:User/mpu/bsp_mpu.c ****     break;
 196              		.loc 1 84 0
 197 005c 0021     		movs	r1, #0
 198              	.LVL20:
 199 005e 0491     		str	r1, [sp, #16]
 200 0060 0391     		str	r1, [sp, #12]
 201 0062 0291     		str	r1, [sp, #8]
 202 0064 0193     		str	r3, [sp, #4]
 203 0066 0092     		str	r2, [sp]
 204 0068 0123     		movs	r3, #1
 205              	.LVL21:
 206 006a 0322     		movs	r2, #3
 207              	.LVL22:
 208 006c FFF7FEFF 		bl	BSP_MPU_ConfigRegion
 209              	.LVL23:
  85:User/mpu/bsp_mpu.c **** 
 210              		.loc 1 85 0
 211 0070 DAE7     		b	.L3
 212              	.LVL24:
 213              	.L10:
  89:User/mpu/bsp_mpu.c ****     break;
 214              		.loc 1 89 0
 215 0072 0021     		movs	r1, #0
 216              	.LVL25:
 217 0074 0491     		str	r1, [sp, #16]
 218 0076 0391     		str	r1, [sp, #12]
 219 0078 0291     		str	r1, [sp, #8]
 220 007a 0193     		str	r3, [sp, #4]
 221 007c 0092     		str	r2, [sp]
 222 007e 0223     		movs	r3, #2
 223              	.LVL26:
 224 0080 0322     		movs	r2, #3
 225              	.LVL27:
 226 0082 FFF7FEFF 		bl	BSP_MPU_ConfigRegion
 227              	.LVL28:
 228              		.loc 1 92 0
 229 0086 CFE7     		b	.L3
 230              		.cfi_endproc
 231              	.LFE142:
 233              		.text
 234              	.Letext0:
 235              		.file 2 "/usr/include/newlib/machine/_default_types.h"
 236              		.file 3 "/usr/include/newlib/sys/_stdint.h"
 237              		.file 4 "Libraries/CMSIS/Include/core_cm7.h"
 238              		.file 5 "Libraries/CMSIS/Device/ST/STM32H7xx/Include/system_stm32h7xx.h"
 239              		.file 6 "/usr/include/newlib/sys/lock.h"
 240              		.file 7 "/usr/include/newlib/sys/_types.h"
 241              		.file 8 "/usr/lib/gcc/arm-none-eabi/6.3.1/include/stddef.h"
 242              		.file 9 "/usr/include/newlib/sys/reent.h"
 243              		.file 10 "/usr/include/newlib/math.h"
 244              		.file 11 "Libraries/STM32H7xx_HAL_Driver/Inc/stm32h7xx_hal_def.h"
 245              		.file 12 "Libraries/STM32H7xx_HAL_Driver/Inc/stm32h7xx_hal_cortex.h"
 246              		.file 13 "Libraries/STM32H7xx_HAL_Driver/Inc/stm32h7xx_hal_flash.h"
 247              		.file 14 "Libraries/STM32H7xx_HAL_Driver/Inc/stm32h7xx_hal.h"
ARM GAS  /tmp/ccsVdeTU.s 			page 7


ARM GAS  /tmp/ccsVdeTU.s 			page 8


DEFINED SYMBOLS
                            *ABS*:0000000000000000 bsp_mpu.c
     /tmp/ccsVdeTU.s:17     .text.BSP_MPU_ConfigRegion:0000000000000000 $t
     /tmp/ccsVdeTU.s:24     .text.BSP_MPU_ConfigRegion:0000000000000000 BSP_MPU_ConfigRegion
     /tmp/ccsVdeTU.s:97     .text.Board_MPU_Config:0000000000000000 $t
     /tmp/ccsVdeTU.s:104    .text.Board_MPU_Config:0000000000000000 Board_MPU_Config
     /tmp/ccsVdeTU.s:124    .text.Board_MPU_Config:000000000000000c $d
                     .debug_frame:0000000000000010 $d
     /tmp/ccsVdeTU.s:129    .text.Board_MPU_Config:0000000000000011 $d
     /tmp/ccsVdeTU.s:129    .text.Board_MPU_Config:0000000000000012 $t

UNDEFINED SYMBOLS
HAL_MPU_Disable
HAL_MPU_ConfigRegion
HAL_MPU_Enable
