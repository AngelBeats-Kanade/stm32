ARM GAS  /tmp/ccdoOkO0.s 			page 1


   1              		.cpu cortex-m7
   2              		.eabi_attribute 28, 1
   3              		.eabi_attribute 20, 1
   4              		.eabi_attribute 21, 1
   5              		.eabi_attribute 23, 3
   6              		.eabi_attribute 24, 1
   7              		.eabi_attribute 25, 1
   8              		.eabi_attribute 26, 1
   9              		.eabi_attribute 30, 1
  10              		.eabi_attribute 34, 1
  11              		.eabi_attribute 18, 4
  12              		.file	"bsp_debug_usart.c"
  13              		.text
  14              	.Ltext0:
  15              		.cfi_sections	.debug_frame
  16              		.section	.text.DEBUG_USART_Config,"ax",%progbits
  17              		.align	1
  18              		.global	DEBUG_USART_Config
  19              		.syntax unified
  20              		.thumb
  21              		.thumb_func
  22              		.fpu fpv5-d16
  24              	DEBUG_USART_Config:
  25              	.LFB142:
  26              		.file 1 "User/usart/bsp_debug_usart.c"
   1:User/usart/bsp_debug_usart.c **** /**
   2:User/usart/bsp_debug_usart.c ****  ******************************************************************************
   3:User/usart/bsp_debug_usart.c ****  * @file    bsp_debug_usart.c
   4:User/usart/bsp_debug_usart.c ****  * @author  fire
   5:User/usart/bsp_debug_usart.c ****  * @version V1.0
   6:User/usart/bsp_debug_usart.c ****  * @date    2016-xx-xx
   7:User/usart/bsp_debug_usart.c ****  * @brief   使用串口1，重定向c库printf函数到usart端口，中断接收模式
   8:User/usart/bsp_debug_usart.c ****  ******************************************************************************
   9:User/usart/bsp_debug_usart.c ****  * @attention
  10:User/usart/bsp_debug_usart.c ****  *
  11:User/usart/bsp_debug_usart.c ****  * 实验平台:野火  STM32 H743 开发板
  12:User/usart/bsp_debug_usart.c ****  * 论坛    :http://www.firebbs.cn
  13:User/usart/bsp_debug_usart.c ****  * 淘宝    :http://firestm32.taobao.com
  14:User/usart/bsp_debug_usart.c ****  *
  15:User/usart/bsp_debug_usart.c ****  ******************************************************************************
  16:User/usart/bsp_debug_usart.c ****  */
  17:User/usart/bsp_debug_usart.c **** 
  18:User/usart/bsp_debug_usart.c **** #include "./usart/bsp_debug_usart.h"
  19:User/usart/bsp_debug_usart.c **** 
  20:User/usart/bsp_debug_usart.c **** UART_HandleTypeDef UartHandle;
  21:User/usart/bsp_debug_usart.c **** extern uint8_t ucTemp;
  22:User/usart/bsp_debug_usart.c **** /**
  23:User/usart/bsp_debug_usart.c ****  * @brief  DEBUG_USART GPIO 配置,工作模式配置。115200 8-N-1
  24:User/usart/bsp_debug_usart.c ****  * @param  无
  25:User/usart/bsp_debug_usart.c ****  * @retval 无
  26:User/usart/bsp_debug_usart.c ****  */
  27:User/usart/bsp_debug_usart.c **** void DEBUG_USART_Config(void)
  28:User/usart/bsp_debug_usart.c **** {
  27              		.loc 1 28 0
  28              		.cfi_startproc
  29              		@ args = 0, pretend = 0, frame = 224
  30              		@ frame_needed = 0, uses_anonymous_args = 0
ARM GAS  /tmp/ccdoOkO0.s 			page 2


  31 0000 70B5     		push	{r4, r5, r6, lr}
  32              	.LCFI0:
  33              		.cfi_def_cfa_offset 16
  34              		.cfi_offset 4, -16
  35              		.cfi_offset 5, -12
  36              		.cfi_offset 6, -8
  37              		.cfi_offset 14, -4
  38 0002 B8B0     		sub	sp, sp, #224
  39              	.LCFI1:
  40              		.cfi_def_cfa_offset 240
  41              	.LBB2:
  29:User/usart/bsp_debug_usart.c ****   GPIO_InitTypeDef GPIO_InitStruct;
  30:User/usart/bsp_debug_usart.c **** 
  31:User/usart/bsp_debug_usart.c ****   RCC_PeriphCLKInitTypeDef RCC_PeriphClkInit;
  32:User/usart/bsp_debug_usart.c **** 
  33:User/usart/bsp_debug_usart.c ****   DEBUG_USART_RX_GPIO_CLK_ENABLE();
  42              		.loc 1 33 0
  43 0004 314C     		ldr	r4, .L3
  44 0006 D4F8E030 		ldr	r3, [r4, #224]
  45 000a 43F00103 		orr	r3, r3, #1
  46 000e C4F8E030 		str	r3, [r4, #224]
  47 0012 D4F8E030 		ldr	r3, [r4, #224]
  48 0016 03F00103 		and	r3, r3, #1
  49 001a 0193     		str	r3, [sp, #4]
  50 001c 019B     		ldr	r3, [sp, #4]
  51              	.LBE2:
  52              	.LBB3:
  34:User/usart/bsp_debug_usart.c ****   DEBUG_USART_TX_GPIO_CLK_ENABLE();
  53              		.loc 1 34 0
  54 001e D4F8E030 		ldr	r3, [r4, #224]
  55 0022 43F00103 		orr	r3, r3, #1
  56 0026 C4F8E030 		str	r3, [r4, #224]
  57 002a D4F8E030 		ldr	r3, [r4, #224]
  58 002e 03F00103 		and	r3, r3, #1
  59 0032 0293     		str	r3, [sp, #8]
  60 0034 029B     		ldr	r3, [sp, #8]
  61              	.LBE3:
  35:User/usart/bsp_debug_usart.c **** 
  36:User/usart/bsp_debug_usart.c ****   /* 配置串口1时钟源*/
  37:User/usart/bsp_debug_usart.c ****   RCC_PeriphClkInit.PeriphClockSelection = RCC_PERIPHCLK_USART1;
  62              		.loc 1 37 0
  63 0036 0126     		movs	r6, #1
  64 0038 0496     		str	r6, [sp, #16]
  38:User/usart/bsp_debug_usart.c ****   RCC_PeriphClkInit.Usart16ClockSelection = RCC_USART16CLKSOURCE_D2PCLK2;
  65              		.loc 1 38 0
  66 003a 0025     		movs	r5, #0
  67 003c 2295     		str	r5, [sp, #136]
  39:User/usart/bsp_debug_usart.c ****   HAL_RCCEx_PeriphCLKConfig(&RCC_PeriphClkInit);
  68              		.loc 1 39 0
  69 003e 04A8     		add	r0, sp, #16
  70 0040 FFF7FEFF 		bl	HAL_RCCEx_PeriphCLKConfig
  71              	.LVL0:
  72              	.LBB4:
  40:User/usart/bsp_debug_usart.c ****   /* 使能串口1时钟 */
  41:User/usart/bsp_debug_usart.c ****   DEBUG_USART_CLK_ENABLE();
  73              		.loc 1 41 0
  74 0044 D4F8F030 		ldr	r3, [r4, #240]
ARM GAS  /tmp/ccdoOkO0.s 			page 3


  75 0048 43F01003 		orr	r3, r3, #16
  76 004c C4F8F030 		str	r3, [r4, #240]
  77 0050 D4F8F030 		ldr	r3, [r4, #240]
  78 0054 03F01003 		and	r3, r3, #16
  79 0058 0393     		str	r3, [sp, #12]
  80 005a 039B     		ldr	r3, [sp, #12]
  81              	.LBE4:
  42:User/usart/bsp_debug_usart.c **** 
  43:User/usart/bsp_debug_usart.c ****   /* 配置Tx引脚为复用功能  */
  44:User/usart/bsp_debug_usart.c ****   GPIO_InitStruct.Pin = DEBUG_USART_TX_PIN;
  82              		.loc 1 44 0
  83 005c 4FF40073 		mov	r3, #512
  84 0060 3393     		str	r3, [sp, #204]
  45:User/usart/bsp_debug_usart.c ****   GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  85              		.loc 1 45 0
  86 0062 0223     		movs	r3, #2
  87 0064 3493     		str	r3, [sp, #208]
  46:User/usart/bsp_debug_usart.c ****   GPIO_InitStruct.Pull = GPIO_PULLUP;
  88              		.loc 1 46 0
  89 0066 3596     		str	r6, [sp, #212]
  47:User/usart/bsp_debug_usart.c ****   GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_HIGH;
  90              		.loc 1 47 0
  91 0068 3693     		str	r3, [sp, #216]
  48:User/usart/bsp_debug_usart.c ****   GPIO_InitStruct.Alternate = DEBUG_USART_TX_AF;
  92              		.loc 1 48 0
  93 006a 0726     		movs	r6, #7
  94 006c 3796     		str	r6, [sp, #220]
  49:User/usart/bsp_debug_usart.c ****   HAL_GPIO_Init(DEBUG_USART_TX_GPIO_PORT, &GPIO_InitStruct);
  95              		.loc 1 49 0
  96 006e A4F58844 		sub	r4, r4, #17408
  97 0072 33A9     		add	r1, sp, #204
  98 0074 2046     		mov	r0, r4
  99 0076 FFF7FEFF 		bl	HAL_GPIO_Init
 100              	.LVL1:
  50:User/usart/bsp_debug_usart.c **** 
  51:User/usart/bsp_debug_usart.c ****   /* 配置Rx引脚为复用功能 */
  52:User/usart/bsp_debug_usart.c ****   GPIO_InitStruct.Pin = DEBUG_USART_RX_PIN;
 101              		.loc 1 52 0
 102 007a 4FF48063 		mov	r3, #1024
 103 007e 3393     		str	r3, [sp, #204]
  53:User/usart/bsp_debug_usart.c ****   GPIO_InitStruct.Alternate = DEBUG_USART_RX_AF;
 104              		.loc 1 53 0
 105 0080 3796     		str	r6, [sp, #220]
  54:User/usart/bsp_debug_usart.c ****   HAL_GPIO_Init(DEBUG_USART_RX_GPIO_PORT, &GPIO_InitStruct);
 106              		.loc 1 54 0
 107 0082 33A9     		add	r1, sp, #204
 108 0084 2046     		mov	r0, r4
 109 0086 FFF7FEFF 		bl	HAL_GPIO_Init
 110              	.LVL2:
  55:User/usart/bsp_debug_usart.c **** 
  56:User/usart/bsp_debug_usart.c ****   /* 配置串DEBUG_USART 模式 */
  57:User/usart/bsp_debug_usart.c ****   UartHandle.Instance = DEBUG_USART;
 111              		.loc 1 57 0
 112 008a 114C     		ldr	r4, .L3+4
 113 008c 114B     		ldr	r3, .L3+8
 114 008e 2360     		str	r3, [r4]
  58:User/usart/bsp_debug_usart.c ****   UartHandle.Init.BaudRate = 115200;
ARM GAS  /tmp/ccdoOkO0.s 			page 4


 115              		.loc 1 58 0
 116 0090 4FF4E133 		mov	r3, #115200
 117 0094 6360     		str	r3, [r4, #4]
  59:User/usart/bsp_debug_usart.c ****   UartHandle.Init.WordLength = UART_WORDLENGTH_8B;
 118              		.loc 1 59 0
 119 0096 A560     		str	r5, [r4, #8]
  60:User/usart/bsp_debug_usart.c ****   UartHandle.Init.StopBits = UART_STOPBITS_1;
 120              		.loc 1 60 0
 121 0098 E560     		str	r5, [r4, #12]
  61:User/usart/bsp_debug_usart.c ****   UartHandle.Init.Parity = UART_PARITY_NONE;
 122              		.loc 1 61 0
 123 009a 2561     		str	r5, [r4, #16]
  62:User/usart/bsp_debug_usart.c ****   UartHandle.Init.Mode = UART_MODE_TX_RX;
 124              		.loc 1 62 0
 125 009c 0C23     		movs	r3, #12
 126 009e 6361     		str	r3, [r4, #20]
  63:User/usart/bsp_debug_usart.c ****   UartHandle.Init.HwFlowCtl = UART_HWCONTROL_NONE;
 127              		.loc 1 63 0
 128 00a0 A561     		str	r5, [r4, #24]
  64:User/usart/bsp_debug_usart.c ****   UartHandle.Init.OverSampling = UART_OVERSAMPLING_16;
 129              		.loc 1 64 0
 130 00a2 E561     		str	r5, [r4, #28]
  65:User/usart/bsp_debug_usart.c ****   UartHandle.Init.OneBitSampling = UART_ONEBIT_SAMPLING_DISABLED;
 131              		.loc 1 65 0
 132 00a4 2562     		str	r5, [r4, #32]
  66:User/usart/bsp_debug_usart.c ****   UartHandle.AdvancedInit.AdvFeatureInit = UART_ADVFEATURE_NO_INIT;
 133              		.loc 1 66 0
 134 00a6 A562     		str	r5, [r4, #40]
  67:User/usart/bsp_debug_usart.c ****   HAL_UART_Init(&UartHandle);
 135              		.loc 1 67 0
 136 00a8 2046     		mov	r0, r4
 137 00aa FFF7FEFF 		bl	HAL_UART_Init
 138              	.LVL3:
  68:User/usart/bsp_debug_usart.c **** 
  69:User/usart/bsp_debug_usart.c ****   /*串口1中断初始化 */
  70:User/usart/bsp_debug_usart.c ****   HAL_NVIC_SetPriority(DEBUG_USART_IRQ, 0, 0);
 139              		.loc 1 70 0
 140 00ae 2A46     		mov	r2, r5
 141 00b0 2946     		mov	r1, r5
 142 00b2 2520     		movs	r0, #37
 143 00b4 FFF7FEFF 		bl	HAL_NVIC_SetPriority
 144              	.LVL4:
  71:User/usart/bsp_debug_usart.c ****   HAL_NVIC_EnableIRQ(DEBUG_USART_IRQ);
 145              		.loc 1 71 0
 146 00b8 2520     		movs	r0, #37
 147 00ba FFF7FEFF 		bl	HAL_NVIC_EnableIRQ
 148              	.LVL5:
  72:User/usart/bsp_debug_usart.c ****   /*配置串口接收中断 */
  73:User/usart/bsp_debug_usart.c ****   __HAL_UART_ENABLE_IT(&UartHandle, UART_IT_RXNE);
 149              		.loc 1 73 0
 150 00be 2268     		ldr	r2, [r4]
 151 00c0 1368     		ldr	r3, [r2]
 152 00c2 43F02003 		orr	r3, r3, #32
 153 00c6 1360     		str	r3, [r2]
  74:User/usart/bsp_debug_usart.c **** }
 154              		.loc 1 74 0
 155 00c8 38B0     		add	sp, sp, #224
ARM GAS  /tmp/ccdoOkO0.s 			page 5


 156              	.LCFI2:
 157              		.cfi_def_cfa_offset 16
 158              		@ sp needed
 159 00ca 70BD     		pop	{r4, r5, r6, pc}
 160              	.L4:
 161              		.align	2
 162              	.L3:
 163 00cc 00440258 		.word	1476543488
 164 00d0 00000000 		.word	UartHandle
 165 00d4 00100140 		.word	1073811456
 166              		.cfi_endproc
 167              	.LFE142:
 169              		.section	.text.Usart_SendString,"ax",%progbits
 170              		.align	1
 171              		.global	Usart_SendString
 172              		.syntax unified
 173              		.thumb
 174              		.thumb_func
 175              		.fpu fpv5-d16
 177              	Usart_SendString:
 178              	.LFB143:
  75:User/usart/bsp_debug_usart.c **** 
  76:User/usart/bsp_debug_usart.c **** /*****************  发送字符串 **********************/
  77:User/usart/bsp_debug_usart.c **** void Usart_SendString(uint8_t *str)
  78:User/usart/bsp_debug_usart.c **** {
 179              		.loc 1 78 0
 180              		.cfi_startproc
 181              		@ args = 0, pretend = 0, frame = 0
 182              		@ frame_needed = 0, uses_anonymous_args = 0
 183              	.LVL6:
 184 0000 38B5     		push	{r3, r4, r5, lr}
 185              	.LCFI3:
 186              		.cfi_def_cfa_offset 16
 187              		.cfi_offset 3, -16
 188              		.cfi_offset 4, -12
 189              		.cfi_offset 5, -8
 190              		.cfi_offset 14, -4
 191 0002 0546     		mov	r5, r0
 192              	.LVL7:
  79:User/usart/bsp_debug_usart.c ****   unsigned int k = 0;
 193              		.loc 1 79 0
 194 0004 0024     		movs	r4, #0
 195              	.LVL8:
 196              	.L6:
  80:User/usart/bsp_debug_usart.c ****   do
  81:User/usart/bsp_debug_usart.c ****   {
  82:User/usart/bsp_debug_usart.c ****     HAL_UART_Transmit(&UartHandle, (uint8_t *)(str + k), 1, 1000);
 197              		.loc 1 82 0 discriminator 1
 198 0006 4FF47A73 		mov	r3, #1000
 199 000a 0122     		movs	r2, #1
 200 000c 2919     		adds	r1, r5, r4
 201 000e 0448     		ldr	r0, .L8
 202 0010 FFF7FEFF 		bl	HAL_UART_Transmit
 203              	.LVL9:
  83:User/usart/bsp_debug_usart.c ****     k++;
 204              		.loc 1 83 0 discriminator 1
 205 0014 0134     		adds	r4, r4, #1
ARM GAS  /tmp/ccdoOkO0.s 			page 6


 206              	.LVL10:
  84:User/usart/bsp_debug_usart.c ****   } while (*(str + k) != '\0');
 207              		.loc 1 84 0 discriminator 1
 208 0016 2B5D     		ldrb	r3, [r5, r4]	@ zero_extendqisi2
 209 0018 002B     		cmp	r3, #0
 210 001a F4D1     		bne	.L6
  85:User/usart/bsp_debug_usart.c **** }
 211              		.loc 1 85 0
 212 001c 38BD     		pop	{r3, r4, r5, pc}
 213              	.LVL11:
 214              	.L9:
 215 001e 00BF     		.align	2
 216              	.L8:
 217 0020 00000000 		.word	UartHandle
 218              		.cfi_endproc
 219              	.LFE143:
 221              		.section	.text.__io_putchar,"ax",%progbits
 222              		.align	1
 223              		.global	__io_putchar
 224              		.syntax unified
 225              		.thumb
 226              		.thumb_func
 227              		.fpu fpv5-d16
 229              	__io_putchar:
 230              	.LFB144:
  86:User/usart/bsp_debug_usart.c **** //重定向c库函数printf到串口DEBUG_USART，重定向后可使用printf函数
  87:User/usart/bsp_debug_usart.c **** #ifdef __GNUC__
  88:User/usart/bsp_debug_usart.c **** int __io_putchar(int ch)
  89:User/usart/bsp_debug_usart.c **** {
 231              		.loc 1 89 0
 232              		.cfi_startproc
 233              		@ args = 0, pretend = 0, frame = 8
 234              		@ frame_needed = 0, uses_anonymous_args = 0
 235              	.LVL12:
 236 0000 00B5     		push	{lr}
 237              	.LCFI4:
 238              		.cfi_def_cfa_offset 4
 239              		.cfi_offset 14, -4
 240 0002 83B0     		sub	sp, sp, #12
 241              	.LCFI5:
 242              		.cfi_def_cfa_offset 16
 243 0004 02A9     		add	r1, sp, #8
 244 0006 41F8040D 		str	r0, [r1, #-4]!
  90:User/usart/bsp_debug_usart.c ****   HAL_UART_Transmit(&UartHandle, (uint8_t *)&ch, 1, 1000);
 245              		.loc 1 90 0
 246 000a 4FF47A73 		mov	r3, #1000
 247 000e 0122     		movs	r2, #1
 248 0010 0348     		ldr	r0, .L12
 249              	.LVL13:
 250 0012 FFF7FEFF 		bl	HAL_UART_Transmit
 251              	.LVL14:
  91:User/usart/bsp_debug_usart.c ****   return ch;
  92:User/usart/bsp_debug_usart.c **** }
 252              		.loc 1 92 0
 253 0016 0198     		ldr	r0, [sp, #4]
 254 0018 03B0     		add	sp, sp, #12
 255              	.LCFI6:
ARM GAS  /tmp/ccdoOkO0.s 			page 7


 256              		.cfi_def_cfa_offset 4
 257              		@ sp needed
 258 001a 5DF804FB 		ldr	pc, [sp], #4
 259              	.L13:
 260 001e 00BF     		.align	2
 261              	.L12:
 262 0020 00000000 		.word	UartHandle
 263              		.cfi_endproc
 264              	.LFE144:
 266              		.comm	UartHandle,140,4
 267              		.text
 268              	.Letext0:
 269              		.file 2 "/usr/include/newlib/machine/_default_types.h"
 270              		.file 3 "/usr/include/newlib/sys/_stdint.h"
 271              		.file 4 "Libraries/CMSIS/Include/core_cm7.h"
 272              		.file 5 "Libraries/CMSIS/Device/ST/STM32H7xx/Include/system_stm32h7xx.h"
 273              		.file 6 "Libraries/CMSIS/Device/ST/STM32H7xx/Include/stm32h743xx.h"
 274              		.file 7 "/usr/include/newlib/sys/lock.h"
 275              		.file 8 "/usr/include/newlib/sys/_types.h"
 276              		.file 9 "/usr/lib/gcc/arm-none-eabi/6.3.1/include/stddef.h"
 277              		.file 10 "/usr/include/newlib/sys/reent.h"
 278              		.file 11 "/usr/include/newlib/math.h"
 279              		.file 12 "Libraries/STM32H7xx_HAL_Driver/Inc/stm32h7xx_hal_def.h"
 280              		.file 13 "Libraries/STM32H7xx_HAL_Driver/Inc/stm32h7xx_hal_rcc_ex.h"
 281              		.file 14 "Libraries/STM32H7xx_HAL_Driver/Inc/stm32h7xx_hal_gpio.h"
 282              		.file 15 "Libraries/STM32H7xx_HAL_Driver/Inc/stm32h7xx_hal_dma.h"
 283              		.file 16 "Libraries/STM32H7xx_HAL_Driver/Inc/stm32h7xx_hal_flash.h"
 284              		.file 17 "Libraries/STM32H7xx_HAL_Driver/Inc/stm32h7xx_hal_uart.h"
 285              		.file 18 "Libraries/STM32H7xx_HAL_Driver/Inc/stm32h7xx_hal.h"
 286              		.file 19 "User/./usart/bsp_debug_usart.h"
 287              		.file 20 "Libraries/STM32H7xx_HAL_Driver/Inc/stm32h7xx_hal_cortex.h"
ARM GAS  /tmp/ccdoOkO0.s 			page 8


DEFINED SYMBOLS
                            *ABS*:0000000000000000 bsp_debug_usart.c
     /tmp/ccdoOkO0.s:17     .text.DEBUG_USART_Config:0000000000000000 $t
     /tmp/ccdoOkO0.s:24     .text.DEBUG_USART_Config:0000000000000000 DEBUG_USART_Config
     /tmp/ccdoOkO0.s:163    .text.DEBUG_USART_Config:00000000000000cc $d
                            *COM*:000000000000008c UartHandle
     /tmp/ccdoOkO0.s:170    .text.Usart_SendString:0000000000000000 $t
     /tmp/ccdoOkO0.s:177    .text.Usart_SendString:0000000000000000 Usart_SendString
     /tmp/ccdoOkO0.s:217    .text.Usart_SendString:0000000000000020 $d
     /tmp/ccdoOkO0.s:222    .text.__io_putchar:0000000000000000 $t
     /tmp/ccdoOkO0.s:229    .text.__io_putchar:0000000000000000 __io_putchar
     /tmp/ccdoOkO0.s:262    .text.__io_putchar:0000000000000020 $d
                     .debug_frame:0000000000000010 $d

UNDEFINED SYMBOLS
HAL_RCCEx_PeriphCLKConfig
HAL_GPIO_Init
HAL_UART_Init
HAL_NVIC_SetPriority
HAL_NVIC_EnableIRQ
HAL_UART_Transmit
